<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MatchScheduleMapper">
	<!-- S001: 일정 등록 -->
	<insert id="addMatchSchedule" parameterType="matchSchedule">
		INSERT INTO
		match_schedule(home_team_id, away_team_id, start_time, duration, cost, writer, reg_date, 
		content, stadium_name, stadium_type, stadium_address, stadium_x, stadium_y, stadium_parking, 
		stadium_shower, match_type)
		VALUES(#{homeTeam.teamId}, #{awayTeam.teamId},#{startTime}, #{duration}, #{cost}, #{writer},
		sysdate(), #{content}, #{stadiumName}, #{stadiumType}, #{stadiumAddress}, #{stadiumX}, #{stadiumY},
		#{stadiumParking}, #{stadiumShower}, #{matchType})
	</insert>
	
	<!-- S002: 방금 등록된 일정 ID 출력 -->
	<select id="showLatestMatchScheduleIdById" parameterType="integer" resultType="integer">
		SELECT
		match_schedule_id
		FROM match_schedule 
		WHERE home_team_id = #{value} 
		OR away_team_id = #{value}
		ORDER BY match_schedule_id 
		DESC limit 1;
	</select>
	
	<!-- S005: 등록된 팀 경기 일정 기간 별 출력 -->
	<select id="showMatchSchduleByTeamPeriod" parameterType="searchKey" resultType="matchSchedule">
		SELECT
		match_schedule_id, start_time, match_type,
		date_add(start_time, interval duration hour) end_time
		FROM match_schedule
		WHERE (home_team_id = #{teamId} OR away_team_id = #{teamId})
		AND (start_time >= #{startTime} AND #{endTime} >= start_time)
	</select>
</mapper>